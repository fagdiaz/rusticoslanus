<div *ngIf="loading">Cargando productos...</div>
<div *ngIf="!loading && error" class="error">{{ error }}</div>
<div *ngIf="!loading && !error && Products.length === 0">
  No hay productos cargados.
</div>

<mat-card *ngIf="!loading && !error && Products.length > 0">
  <a
    *ngIf="rolActual === 'admin'"
    mat-button
    color="primary"
    class="add-button"
    routerLink="/addproduct"
  >
    Añadir producto nuevo
  </a>

  <div class="product-grid">
    <ng-container *ngFor="let product of Products">
      <mat-card
        *ngIf="mostrarProducto(product)"
        class="product-card"
        [class.inactivo]="!product.activo"
      >
        <div class="product-content">
          <div class="product-info">
            <div class="producto-header">
              <h2>{{ product.nombre }}</h2>
              <span
                *ngIf="rolActual === 'admin' && product.activo === false"
                class="badge-inactivo"
              >
                INACTIVO
              </span>
            </div>

            <div
              class="producto-actions"
              *ngIf="rolActual === 'admin'"
            >
            <button mat-button color="primary" (click)="openEditDialog(product)">
                Editar
              </button>

              <button mat-button color="warn" (click)="onSoftDelete(product)">
                Eliminar
              </button>
            </div>

            <p class="description">Descripción: {{ product.descripcion }}</p>
            <p>Precio: ${{ product.precio }}</p>
          </div>

          <div class="add-to-cart-button">
            <button mat-button color="primary" (click)="addProduct(product.id, product.nombre, product.descripcion, product.precio)">+</button>
            <input type="number" [value]="getCartItemQuantity(product.id)" name="cantidad" />
            <button mat-button color="primary" (click)="removeProduct(product.id)">-</button>
          </div>
        </div>
      </mat-card>
    </ng-container>
  </div>
</mat-card>
