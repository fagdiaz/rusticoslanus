<div class="admin-page">
  <header class="admin-header">
    <div>
      <p class="eyebrow">Administracion</p>
      <h2>Usuarios</h2>
    </div>
    <div class="filters-bar">
      <label class="filter-field">
        <span>Email</span>
        <input
          type="text"
          placeholder="filtrar por email"
          [(ngModel)]="filtroEmail"
          (keyup.enter)="aplicarFiltros()"
        />
      </label>
      <label class="filter-field">
        <span>DNI</span>
        <input
          type="text"
          placeholder="filtrar por DNI"
          [(ngModel)]="filtroDni"
          (keyup.enter)="aplicarFiltros()"
        />
      </label>
      <div class="filters-actions">
        <button type="button" class="btn primary" (click)="aplicarFiltros()">Aplicar</button>
        <button type="button" class="btn ghost" (click)="limpiarFiltros()">Limpiar</button>
      </div>
    </div>
  </header>

  <section class="admin-body">
    <div *ngIf="loading" class="status">Cargando usuarios...</div>
    <div *ngIf="error" class="status error">{{ error }}</div>

    <div class="table-container" *ngIf="!loading">
      <div *ngIf="!usuariosFiltrados.length" class="empty-state">
        No hay usuarios para mostrar.
      </div>

      <div class="table-wrapper" *ngIf="usuariosFiltrados.length">
        <table class="admin-table">
          <thead>
            <tr>
              <th>Email</th>
              <th>DNI</th>
              <th>Rol</th>
              <th>Estado</th>
              <th>Acciones</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let user of usuariosFiltrados">
              <td>{{ user.email }}</td>
              <td>{{ user.dni ? user.dni : 'N/A' }}</td>
              <td class="table-control">
                <select #rolSelect [value]="user.rol" (change)="onRolChange(user, rolSelect.value)">
                  <option value="admin">Admin</option>
                  <option value="operador">Operador</option>
                  <option value="cliente">Cliente</option>
                </select>
              </td>
              <td>
                <span class="estado-pill" [class.on]="user.activo" [class.off]="!user.activo">
                  {{ user.activo ? 'Activo' : 'Inactivo' }}
                </span>
              </td>
              <td class="table-actions">
                <button type="button" class="action-btn" (click)="onActivoToggle(user)">
                  {{ user.activo ? 'Desactivar' : 'Activar' }}
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </section>
</div>
